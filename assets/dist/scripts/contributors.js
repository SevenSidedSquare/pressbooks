(()=>{"use strict";const t=function(t,e,r){var i=jQuery(t);i.attr("aria-describedby",r);var a=i.parent().find(e);(a=a.length?a:i.parent().parent().find(e)).attr("id",r)};jQuery((function(e){var r=parseInt(pictureSize.min),i=jQuery("#contributor-picture"),a=jQuery("#contributor-picture-thumbnail");jQuery("#slug").attr("readonly",!0);for(var n=0,o=["tag-name","name","tag-slug","slug","btn-media"];n<o.length;n++){var s=o[n];t("#".concat(s),"p","".concat(s,"-description"))}var d=function(t,e){var i,a,n,o,s,d,c,u,l,p=t.get("width"),g=t.get("height"),m=r,h=r,v=m,y=h,w=2*r;e.set("canSkipCrop",(s=!1,d=m,c=h,u=p,l=g,!!(!0===(o=!1)&&!0===s||!0===o&&c===l||!0===s&&d===u||d===u&&c===l||u<=d))),p/g>1?m=1*(h=g>w?w:g):h=(m=p>w?w:p)/1,i=(p-m)/2,a=(g-h)/2;var f=g>r||p>r;return n={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:p,imageHeight:g,minWidth:v>m?m:v,minHeight:y>h?h:y,x1:f?i-1:i,y1:f?a-1:a,x2:f?m+i-1:m+i,y2:f?h+a-1:h+a},n.aspectRatio=m+":"+h,n};jQuery(document).ajaxComplete((function(t,e,r){r.data.indexOf("action=add-tag")>=0&&(window.tinyMCE.activeEditor.setContent(""),a.attr("src","").hide(),i.val(""))})),jQuery(document).ajaxSend((function(t,e,r){if(r.data.indexOf("action=add-tag")>=0){window.tinyMCE.triggerSave();var i=new URLSearchParams(r.data);i.set("contributor_description",window.tinyMCE.activeEditor.getContent()),r.data=i.toString()}})),jQuery(".term-description-wrap").remove(),jQuery("#contributor-media-picture").hide(),jQuery("#wpbody-content > div.wrap.nosubsub > form").css("margin",0),jQuery("#btn-media").on("click",(function(t){t.preventDefault(),jQuery("#plupload-browse-button").click()})),jQuery("#plupload-browse-button").on("click",(function(t){var e=wp.media.controller.CustomizeImageCropper.extend({doCrop:function(t){var e=t.get("cropDetails"),i=parseInt(r);return e.dst_width=i,e.dst_height=i,wp.ajax.post("crop-image",{nonce:t.get("nonces").edit,id:t.get("id"),cropDetails:e})}}),n=wp.media({button:{text:"Done",close:!1},states:[new wp.media.controller.Library({title:"Select a picture",library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:r,suggestedHeight:r}),new e({imgSelectOptions:d})]});t.preventDefault(),n.open(),n.on("cropped",(function(t){i.val(t.url),a.attr("src",t.url).show()})),n.on("insert",(function(){var t=n.state().get("selection").first().toJSON();i.val(t.url),a.attr("src",t.url).show()})),n.on("select",(function(){var t=n.state().get("selection").first().toJSON();if(t.width<r||t.height<r){var e='<div class="media-uploader-status errors"><div class="upload-errors"><div class="upload-error">\n<span class="upload-error-filename">Your image is too small.</span><span class="upload-error-message">The image must be '+r+" by "+r+" pixels. Your image is "+t.width+" by "+t.height+" pixels.</span></div></div></div>";jQuery(".media-sidebar").html(e)}else t.width!==r||t.height!==r?n.setState("cropper"):(i.val(t.url),a.attr("src",t.url).show(),n.close())}))}))}))})();