jQuery((function(e){var t=jQuery("#contributor-picture"),i=jQuery("#contributor-picture-thumbnail"),r=function(e,t){var i,r,n,o,a,c,u,d,s,m=e.get("width"),p=e.get("height"),l=minPictureSize,g=minPictureSize,S=l,h=g;return t.set("canSkipCrop",(a=!1,c=l,u=g,d=m,s=p,!!(!0==(o=!1)&&!0===a||!0===o&&u===s||!0===a&&c===d||c===d&&u===s||d<=c))),m/p>1?l=1*(g=p):g=(l=m)/1,r=(p-g)/2,n={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:m,imageHeight:p,minWidth:S>l?l:S,minHeight:h>g?g:h,x1:i=(m-l)/2,y1:p>minPictureSize||m>minPictureSize?r-1:r,x2:p>minPictureSize||m>minPictureSize?l+i-1:l+i,y2:p>minPictureSize||m>minPictureSize?g+r-1:g+r},n.aspectRatio=l+":"+g,n};jQuery(document).ajaxComplete((function(e,r,n){n.data.indexOf("action=add-tag")>=0&&(window.tinyMCE.activeEditor.setContent(""),i.attr("src","").hide(),t.val(""))})),jQuery(document).ajaxSend((function(e,t,i){if(i.data.indexOf("action=add-tag")>=0){window.tinyMCE.triggerSave();var r=new URLSearchParams(i.data);r.set("contributor_description",window.tinyMCE.activeEditor.getContent()),i.data=r.toString()}})),jQuery(".term-description-wrap").remove(),jQuery("#contributor-media-picture").hide(),jQuery("#wpbody-content > div.wrap.nosubsub > form").css("margin",0),jQuery("#btn-media").on("click",(function(e){e.preventDefault(),jQuery("#plupload-browse-button").click()})),jQuery("#plupload-browse-button").on("click",(function(e){var n=wp.media.controller.CustomizeImageCropper.extend({doCrop:function(e){var t=e.get("cropDetails");return t.dstWidth=minPictureSize,t.dstHeight=minPictureSize,wp.ajax.post("crop-image",{nonce:e.get("nonces").edit,id:e.get("id"),cropDetails:t})}}),o=wp.media({button:{text:"Done",close:!1},states:[new wp.media.controller.Library({title:"Select a picture",library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:minPictureSize,suggestedHeight:minPictureSize}),new n({imgSelectOptions:r})]});e.preventDefault(),o.open(),o.on("cropped",(function(e){t.val(e.url),i.attr("src",e.url).show()})),o.on("insert",(function(){var e=o.state().get("selection").first().toJSON();t.val(e.url),i.attr("src",e.url).show()})),o.on("select",(function(){var e=o.state().get("selection").first().toJSON();e.width<minPictureSize||e.height<minPictureSize||(e.width!==minPictureSize||e.height!==minPictureSize?o.setState("cropper"):(t.val(e.url),i.attr("src",e.url).show(),o.close()))}))}))}));