jQuery((function(t){t(document).ready((function(){var t=400;jQuery(document).ajaxComplete((function(t,e,r){r.data.indexOf("action=add-tag")>=0&&(window.tinyMCE.activeEditor.setContent(""),jQuery("#contributor-picture-thumbnail").attr("src","").hide(),jQuery("#contributor-picture").val(""))})),jQuery(document).ajaxSend((function(t,e,r){if(r.data.indexOf("action=add-tag")>=0){window.tinyMCE.triggerSave();var i=new URLSearchParams(r.data);i.set("contributor_description",window.tinyMCE.activeEditor.getContent()),r.data=i.toString()}})),jQuery(".term-description-wrap").remove(),jQuery("#contributor-media-picture").hide(),jQuery("#wpbody-content > div.wrap.nosubsub > form").css("margin",0),jQuery("#btn-media").on("click",(function(t){t.preventDefault(),jQuery("#plupload-browse-button").click()})),jQuery("#plupload-browse-button").on("click",(function(e){var r=wp.media.controller.SiteIconCropper.extend({doCrop:function(e){var r=e.get("cropDetails");return r.dst_width=t,r.dst_height=t,wp.ajax.post("crop-image",{nonce:e.get("nonces").edit,id:e.get("id"),context:"site-icon",cropDetails:r})}}),i=wp.media({button:{text:"Done",close:!1},states:[new wp.media.controller.Library({title:"Select a picture",library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:t,suggestedHeight:t}),new r({imgSelectOptions:function(e,r){var i,n,o,a,u,c,d,s,p,l=!1,y=!1,g=e.get("width"),m=e.get("height"),h=t,b=t,w=h,j=b;return r.set("canSkipCrop",(u=y,c=h,d=b,s=g,p=m,!!(!0===(a=l)&&!0===u||!0===a&&d===p||!0===u&&c===s||c===s&&d===p||s<=c))),g/m>1?h=1*(b=m):b=(h=g)/1,o={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:g,imageHeight:m,minWidth:w>h?h:w,minHeight:j>b?b:j,x1:i=(g-h)/2,y1:n=(m-b)/2,x2:h+i,y2:b+n},o.aspectRatio=h+":"+b,o}})]});e.preventDefault(),i.open(),i.on("cropped",(function(t){jQuery("#contributor-picture").val(t.url),jQuery("#contributor-picture-thumbnail").attr("src",t.url).show()})),i.on("insert",(function(){var t=i.state().get("selection").first().toJSON();jQuery("#contributor-picture").val(t.url),jQuery("#contributor-picture-thumbnail").attr("src",t.url).show()})),i.on("select",(function(){var e=i.state().get("selection").first().toJSON();e.width!==t||e.height!==t?i.setState("cropper"):(jQuery("#contributor-picture").val(e.url),jQuery("#contributor-picture-thumbnail").attr("src",e.url).show(),i.close())}))}))}))}));