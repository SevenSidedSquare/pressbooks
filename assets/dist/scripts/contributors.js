jQuery((function(t){var e=pictureSize.min,i=jQuery("#contributor-picture"),r=jQuery("#contributor-picture-thumbnail"),n=function(t,i){var r,n,o,a,c,u,d,s,p,l=t.get("width"),g=t.get("height"),m=e,h=e,w=m,y=h;return i.set("canSkipCrop",(c=!1,u=m,d=h,s=l,p=g,!!(!0==(a=!1)&&!0===c||!0===a&&d===p||!0===c&&u===s||u===s&&d===p||s<=u))),l/g>1?m=1*(h=g):h=(m=l)/1,n=(g-h)/2,o={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:l,imageHeight:g,minWidth:w>m?m:w,minHeight:y>h?h:y,x1:r=(l-m)/2,y1:g>e||l>e?n-1:n,x2:g>e||l>e?m+r-1:m+r,y2:g>e||l>e?h+n-1:h+n},o.aspectRatio=m+":"+h,o};jQuery(document).ajaxComplete((function(t,e,n){n.data.indexOf("action=add-tag")>=0&&(window.tinyMCE.activeEditor.setContent(""),r.attr("src","").hide(),i.val(""))})),jQuery(document).ajaxSend((function(t,e,i){if(i.data.indexOf("action=add-tag")>=0){window.tinyMCE.triggerSave();var r=new URLSearchParams(i.data);r.set("contributor_description",window.tinyMCE.activeEditor.getContent()),i.data=r.toString()}})),jQuery(".term-description-wrap").remove(),jQuery("#contributor-media-picture").hide(),jQuery("#wpbody-content > div.wrap.nosubsub > form").css("margin",0),jQuery("#btn-media").on("click",(function(t){t.preventDefault(),jQuery("#plupload-browse-button").click()})),jQuery("#plupload-browse-button").on("click",(function(t){var o=wp.media.controller.CustomizeImageCropper.extend({doCrop:function(t){var i=t.get("cropDetails");return i.dstWidth=e,i.dstHeight=e,wp.ajax.post("crop-image",{nonce:t.get("nonces").edit,id:t.get("id"),cropDetails:i})}}),a=wp.media({button:{text:"Done",close:!1},states:[new wp.media.controller.Library({title:"Select a picture",library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:e,suggestedHeight:e}),new o({imgSelectOptions:n})]});t.preventDefault(),a.open(),a.on("cropped",(function(t){i.val(t.url),r.attr("src",t.url).show()})),a.on("insert",(function(){var t=a.state().get("selection").first().toJSON();i.val(t.url),r.attr("src",t.url).show()})),a.on("select",(function(){var t=a.state().get("selection").first().toJSON();t.width<e||t.height<e||(t.width!==e||t.height!==e?a.setState("cropper"):(i.val(t.url),r.attr("src",t.url).show(),a.close()))}))}))}));